博客系统功能规划

布告
功能
（8.22）使用bootstrap和jquery和插件
（8.22）所有的页面最上边均是表明用户的身份
（8.22）采用邮箱和用户编号登录
（8.22）密码均需加密后输入数据库
（8.22）评论最多140个字符
（8.22）分页，每十篇要分，文章超过一千个字符要分
（8.22）文章中允许携带html字符
（8.22）不允许用户之前针对某个文章相互评论
（8.22）管理员可以设置各个一句话标语


游客
（8.22）评论博客文章
（8.22）修改自己的账号信息
（8.22）申请成为作者

作者
（8.22）修改自己的信息
（8.22）编辑文章
（8.22）查看用户评论

编辑
（8.22）审核发表文章
（8.22）查看游客和作者的详细信息（不包括密码）,
（8.22）审核游客的评论,关注游客的申请

数据库设计
1、用户，L_zhang_blog_username,user_id,email,staff_number,username,password,qxian

2、文章，L_zhang_blog_content,blog_id,user_id,classify_id,blog_title,blog_content,publish_time,read_time,

3、分类，L_zhang_blog_classify,classify_id,classify_name,classify_time

4、评论，L_zhang_blog_comment,comment_id,blog_id,user_id,comment_content,comment_time,



index.asp
功能：
1，登录页面，不采用ajax
2，侧边栏展示博客的分类
3，显示最新的博客和阅读量最大的博客文章各三篇
4，点击文章下面的作者的链接时可以，跳转搜索这个作者的所有文章
5, 用户状态栏刚开始不显示，当页面滚动到一定的像素后开始显示！！！！！！！！
6, 对侧边栏实现自动定位浮标

content.asp
功能：
1、具体的博客文章页面
2、游客和作者（包括自己）可以评论
3,关键字 blog_id 由首页携带id进行跳转

classify.asp
功能：
博客的文章列表分类页面
3,关键字 newest   hottest  writer (writer="作者")  time (time="日期")
1，当用户没有通过首页而是直接进入分类页面时，默认的是选择'安全'类别，这里还需要优化

loin.asp
功能：
账号信息注册页面
1、游客和作者均需自己注册
2、使用ajax进行验证

logout.asp

deal.asp（login.asp）
功能：
1，处理数据，设置session或者cookies，并跳转相关页面


manage.asp
功能：
1，编辑的后台页面
2，查看，游客和作者的信息
3，审核，游客申请作者，
6，游客的评论是否通过
4，添加，修改，博客的分类
5，文章管理，发表的文章是否通过，已经发表的是否删除

editor.asp
功能：
1，作者的后台页面
2，发表文章，删除文章，修改文章
3，查看用户对文章的评论

user.asp
功能：
1，用户的后台页面
2，查看对文章的各个评价，可删除




css
base.css是每个页面都要引入的


输出当前地址栏
<%response.write Request.ServerVariables("SERVER_NAME") %>




数据库查询语句
1,qxian,为1,2,3可以使用bit int
2,十个汉字，varchar(20)，当没有十个时也没有关系
3，

测试语句
insert into L_zhang_login (staffNumber,username,psword,qxian,dat) values ('2222','2222','5555','2','2016.8.8')
select * from L_zhang_login

博客内容表  a
insert into L_zhang_blog_content (user_id,classify_id,blog_title,blog_content,publish_time,read_time) values ('1','1','第一篇博客','这是我的第一篇博客，大家来看看吧','2019.8.5','1')
select top 3* from L_zhang_blog_content order by publish_time desc

update L_zhang_blog_content set blog_title='第2篇博客',blog_content='这是我的第2篇博客，大家来看看吧',classify_id='3'where blog_id='2'
select * from L_zhang_blog_content

用户表  b
insert into L_zhang_blog_username (email,staff_number,username,password,qxian) values ('755201244@qq.com','162631','一德','162631','2')
select * from L_zhang_blog_username


分类表  c
insert into L_zhang_blog_classify (classify_name,classify_time) values ('医疗','2016.8.8')
select * from L_zhang_blog_classify

评论表   d
insert into L_zhang_blog_comment (blog_id,user_id,comment_content,comment_time) values ('2','1','这是第四条博客评论','2015.4.5')
select * from L_zhang_blog_comment




select top 3 a.*,b.username as username from L_zhang_blog_content a,L_zhang_blog_username b where  a.user_id = b.user_id order by a.publish_time desc


 			

首页查询，博客分类以及相应的数量
select c.classify_name,count(a.classify_id) as count from L_zhang_blog_classify c left join L_zhang_blog_content a   on a.classify_id=c.classify_id group by c.classify_name



		 'application.Lock();
		 'application(blog_id)=read_time
'
'		if application("blog_id")<>"" then
'				application("blog_id")=application("blog_id")+1
'					   'sql="update  L_zhang_blog_content set read_time ='"&read_time&"' where blog_id='"&blog_id& "'"
'	                   'conn.execute(sql)
'		else
'				application("blog_id")=1
'		end if 
'		application.unlock(); 
'		response.Write(application("blog_id"))


Function RegExpTest(patrn, strng)
  Dim regEx, Match, Matches      ' 建立变量。
  Set regEx = New RegExp         ' 建立正则表达式。
  regEx.Pattern = patrn         ' 设置模式。
  regEx.IgnoreCase = True         ' 设置是否区分大小写。
  regEx.Global = True         ' 设置全程可用性。
  Set Matches = regEx.Execute(strng)   ' 执行搜索。
  For Each Match in Matches      ' 遍历 Matches 集合。
    RetStr = RetStr & "匹配 " & I & " 位于 "
    RetStr = RetStr & Match.FirstIndex & "。匹配的长度为"
    RetStr = RetStr & Match.Length 
    RetStr = RetStr & "个字符。" & vbCRLF
  Next
  RegExpTest = RetStr
End Function


	       ' ' const maxperpage=20
'				 dim currentpage
'				 dim totalpages
'				 
'				 if not isempty(request("page")) then
'				    currentpage=cint(request("page"))
'				 else
'				    currentpage=1
'				 end if
'		          
'				 set rs = Server.CreateObject("ADODB.Recordset")
'				 sql="select * from table order by xx desc"
'				 rs.open sql,conn,1,1
'				 
'				 
'		         if rs.eof and rs.bof then 
'				      response.Write "还没有任何的信息"
'				 else
'				     totalpages=re.recordcount
'					 if currentpage<1 then 
'					    currentpage=1
'					 end if
'		             if(currentpage-1)*maxperpage>totalpages then
'					       if(totalpages mod maxperpage)=0 then
'						       currentpage=totalpages\maxperpage
'						   else
'						       currentpage=totalpages\maxperpage+1
'						   end if
'					 end if
'					 
'					 if currentpage=1 then
'					    
'		            if(totalpages mod maxperpage)=0 then
'					    n=totalpages\maxperpage 
'					else
'					    n=totalpages\maxperpage+1
'					end if  


Sub CreatePageNumber(CreatePageNumber_rs,CreatePageNumber_Page,CreatePageNumber_Url)
	RecordCount=rs.recordcount
	CreatePageNumber_PageCount=rs.pagecount
	response.Write "&nbsp;总&nbsp;"&RecordCount&"&nbsp;条记录&nbsp;&nbsp;共&nbsp;"&CreatePageNumber_PageCount&"&nbsp;页&nbsp;"
	NowStart=CreatePageNumber_Page-3
	if NowStart<1 then
		NowStart=1
	end if
	NowEnd=CreatePageNumber_Page+3
	if NowEnd>CreatePageNumber_PageCount then
		NowEnd=CreatePageNumber_PageCount
	end if
	if trim(CreatePageNumber_Url)<>"" then
		CreatePageNumber_Url="&"&CreatePageNumber_Url
	end if
	response.write "&nbsp;<a href='?T_Page=1"&CreatePageNumber_Url&"' style='color:#0000FF'>最前页</a>&nbsp;"
	for ipage=NowStart to NowEnd
		if cstr(ipage)=cstr(CreatePageNumber_Page) then
			response.write "&nbsp;<span style='color:#FF0000'>" & ipage &"</span>&nbsp;"
		else
			response.write "&nbsp;[&nbsp;<a href='?T_Page="&ipage&CreatePageNumber_Url&"' style='color:#0000FF'>" & ipage &"</a>&nbsp;]&nbsp;"
		end if
	next
	response.write "&nbsp;<a href='?T_Page="&CreatePageNumber_PageCount&CreatePageNumber_Url&"' style='color:#0000FF'>最后页</a>&nbsp;"
End Sub


					
					dim txt
txt="This is a beautiful day!"
response.write(Mid(txt,1,4))
					
		 
		 
		 
		 
		 
查询条件语句		 
dim k,ky,qxian
		         if request.form("identify")="author" then
				      k="a.username"
				 elseif request.form("identify")="title" then	  
					  k="b.blog_title"
				 end if
				 ky=request.form("searchkeyword")
				 
				 
				 
				 
				 
				 
				 
				 if request.form("qxain")<>"" then
				    qxian=request.form("qxain")    
				    p="qxian='"&qxian&"' "
				 end if
				 if request.form("user_id") <>"" then
					user_id=request.form("user_id")
					p=p&"and user_id='"&user_id&"' "
				 end if
				 
				 if request.form("sex") <>""then
				    sex=request.form("sex")
				    p=p&"and sex='"&sex&"' "
				 end if 
				 
				 qxian=request.form("qxain")
				 user_id=request.form("user_id")
				 
				 p="qxian="&qxian&" and user_id="&user_id
				 
				 sql="select a.blog_id,a.blog_title,a.publish_time,a.read_time,b.username from L_zhang_blog_content a,L_zhang_blog_username b where "&k&" like '%"&ky&"%' order by a.read_time desc"	 
				 
				 
				 
classify.asp			 
session("action")=action
session("time")=request.QueryString("time")
session("classify_name")=request.QueryString("classify_name")
session("writer")=request.QueryString("writer") 			 

deal.asp
session("user_id")=rs("user_id")


content.asp
session("blog_id")=rs("blog_id")
